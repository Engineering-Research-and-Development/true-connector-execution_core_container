# ISO 62443-4-2

| Crit_id    | Name                                                                              | TRUE Connector                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ---------- | --------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| CR_1_1     | Human user identification and authentication                                      | Password protected API endpoint for manipulating Self Description and Proxy endpoint                                                                                                                                                                                                                                                                                                                                                                                            |
| CR_1_1_1   | Unique identification and authentication - human user                             | Simple user management, only one user is available (admin user)                                                                                                                                                                                                                                                                                                                                                                    |
| CR_1_1_2   | Multi-factor authentication for all interfaces                                    | -                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| CR_1_2     | Software process and device identification and authentication                     | Identifying with DAT token when sending request; Public Key obtained from ISP in self description?                                                                                                                                                                                                                                                                                                                                                           |
| CR_1_2_1   | Unique identification and authentication - other components                       | Public key from Identity certificate is present in connector Self Description document                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_1_3     | Account management                                                                | Simple account management (property files, API for password change), 2 users API and Proxy                                                                                                                                                                                                    |
| CR_1_4     | Identifier management                                                             | Support for Let'sEncrypt certificate for TLS/SSL communication between components (connectors)                                                                                                                                                                                                                                                                                                                                                             |
| CR_1_5     | Authenticator management                                                          | Authorization header required for all public endpoints; IDS specification does not foresee authorization on data endpoint                                                                                                                                                                                                                                                                                                |
| CR_1_5_1   | Hardware security for authenticators                                              | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_1_7     | Strength of password-based authentication                                         | When setting new password for API and Proxy endpoint user, password strength will be enforced; managed through property file                                                                                                                                                                       |
| CR_1_7_1   | Password generation and lifetime restrictions for human users                     | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_1_7_2   | Password lifetime restrictions for all users (human, software process or device)  | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_1_8     | Public key infrastructure certificates                                            | Let's Encrypt certificate, PKI infrastructure with CA, intermediate CA and endpoint cert should be sufficient; Let'sEncrypt follows best practices                                                                                                                                                                                                                                                                                        |
| CR_1_9     | Strength of public key-based authentication                                       | Based on CR_1_8                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| CR_1_9_1   | Hardware security for public key-based authentication                             | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_1_10    | Authenticator feedback                                                            | self description API<br>{<br>    "timestamp": "2022-09-20T10:33:43.012+0000",<br>    "status": 401,<br>    "error": "Unauthorized",<br>    "message": "Unauthorized",<br>    "path": "/api/selfDescription/"<br>}                                                                                                                                                                                                                                            |
| CR_1_11    | Unsuccessful login attempts                                                       | Implemented lock mechanism for API user only                                                                                                                                                                                             |
| *CR_1_12*  | System use notification                                                           | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_1_14    | Strength of symmetric key-based authentication                                    | Using asymmetric public and private key pair                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| CR_1_14_1  | Hardware security for symmetric key-based authentication                          | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_2_1     | Authorization enforcement                                                         | 2 users, one for API management, other user for Proxy endpoint                                                                                                                                                                                             |
| CR_2_1_1   | Authorization enforcement for all users (humans, software processes and  devices) | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_2_1_2   | Permission mapping to roles                                                       | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| *CR_2_1_3*   | Supervisor override                                                             | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_2_1_4   | Dual approval                                                                     | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_2_2     | Wireless use control                                                              | not applicable                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| CR_2_3     | Use control for portable and mobile devices                                       | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_2_5     | Session lock                                                                      | Implemented lock mechanism for API user                                                                                                                                                                                                                                                                                                                                          |
| CR_2_6     | Remote session termination                                                        | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| *CR_2_7*   | Concurrent session control                                                        | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_2_8     | Auditable events                                                                  | Audit logs for SelfDescription API and camel routes                                                                                                                                                                                                                                                                                                                             |
| CR_2_9     | Audit storage capacity                                                            | Audit logs will be written to docker volumes;<br>monitoring of disk space added to ECC; for now, just to log into file used and remaining disk space                                                                                                                                                                                                       |
| CR_2_9_1   | Warn when audit record storage capacity threshold reached                         | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| *CR_2_10*  | Response to audit processing failures                                             | Usage of docker volumes to store audit logs                                                                                                                                                                                                                                                                                           |
| CR_2_11    | Timestamps                                                                        | Timestamp present in (audit) logs                                                                                                                                                                                                                                                                                                                        |
| CR_2_11_1  | Time synchronization                                                              | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_2_11_2  | Protection of time source integrity                                               | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_2_12    | Non-repudiation                                                                   | Audit event is created when user modifies Self Description                                                                                                                                                                                                                                                   |
| CR_2_12_1  | Non-repudiation for all users                                                     | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_3_1     | Communication integrity                                                           | Securing data in transit, using TLS channel to transmit data in order to keep data integrity                                                                                                                                                                                                                                                                                                                                                           |
| CR_3_1_1   | Communication authentication                                                      | Establish TLS, validate DAT, check transportCertsSha256 for TLS channel, check signature                                                                                                                                                                                                                                                                                                                                                 |
| *CR_3_3*     | Security functionality verification                                             | Industry domain specific; can extend dataApp to support such functionality                                                                                                                                                                                                                               |
| *CR_3_3_1*   | Security functionality verification during normal operation                     | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_3_4     | Software and information integrity                                                | Docker images are signed and signature can be verified using cosign and public key                                                                                                                                                                                                                                     |
| CR_3_4_1   | Authenticity of software and information                                          | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_3_4_2   | Automated notification of integrity violations                                    | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| *CR_3_5*     | Input validation                                                                | DataApp responsibility                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| *CR_3_6*     | Deterministic output                                                            | DataApp responsibility                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| *CR_3_7*     | Error handling                                                                  | Errors are not leaked outside component, all errors are translated to rejection messages                                                                                                                                                                                                                                                                                                                                                                      |
| CR_3_8     | Session integrity                                                                 | No session handling, not applicable;                                                                                                                                                                                                                                                                                                                                                                                                                         |
| CR_3_9     | Protection of audit information                                                   | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_3_9_1   | Audit records on write-once media                                                 | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_4_1     | Information confidentiality                                                       | TLS is used for protection in transit<br>No data persistence is implemented in TRUE Connector, always have to request data from provider                                                                                                                                                                                                                                                                                                                                              |
| CR_4_2     | Information persistence                                                           | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_4_2_1   | Erase of shared memory resources                                                  | Implemented Cleaner interface on domain class                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| CR_4_2_2   | Erase verification                                                                | -                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| CR_5_1     | Network segmentation                                                              | Platform and applications are configured in network segments via docker compose                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| CR_5_4     | Application partitioning                                                          | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_6_1     | Audit log accessibility                                                           | Audit logs are written to docker volume, access to docker volume should be provided on OS level                                                                                                                                                                                                                                                                                                                                            |
| CR_6_1_1   | Programmatic access to audit logs                                                 | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_6_2     | Continuous monitoring                                                             | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| *CR_7_1*     | Denial of service protection                                                    | Depending on industry domain, before or after the connector                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| *CR_7_1_1*   | Manage communication load from component                                        | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_7_2     | Resource management                                                               | Initial values for CPU and memory usage for docker services                                                                                                                                                                                                                                                                                                                                                                    |
| CR_7_3     | Control system backup                                                             | Docker volumes for transit data<br> property files should be backed up by the administrator of the system                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| CR_7_3_1   | Backup integrity verification                                                     | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_7_4     | Control system recovery and reconstitution                                        | Restart docker containers if system becomes unstable or needs recovery<br> restore backup configuration and docker volumes                                                                                                                                                                                                                                                                                                                                                                                      |
| CR_7_5     | Emergency power                                                                   | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_7_6     | Network and security configuration settings                                       | Docker networking in place                                                                                                                                                                                                                                                                                                                         |
| CR_7_6_1   | Machine-readable reporting of current security settings                           | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| CR_7_7     | Least functionality                                                               | Only external ports are exposed outside docker network                                                                                                                                                                                                                                                   |
| *CR_7_8*     | Control system component inventory                                              | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_1_6    | Wireless Access Management                                                        | No wireless access, not applicable<br>If referred to access on remote machine (server) this can be machine specific (depends on the host) |
| NDR_1_6_1  | Unique identification and authentication                                          | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_1_13   | Access via untrusted networks                                                     | Added username&password requirement for all public endpoints (proxy endpoint, specification for data endpoint does not have such requirement)                                                                                                                                                                        |
| NDR_1_13_1 | Explicit access request approval                                                  | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_2_4    | Mobile code                                                                       | No libraries are loaded during runtime - not applicable<br>Code outside existing docker images - mobile code; if doing so - check integrity of new component before executing it                                                                                                                                                                                                                                                                                                                                                      |
| NDR_2_4_1  | Mobile code authenticity check                                                    | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_2_13   | Use of physical diagnostic and test interfaces                                    | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_2_13_1 | Active monitoring                                                                 | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_3_2    | Protection from malicious code                                                    | Check hash, signature, integrity for new code before executing it                                                                                                                                                                                                                                                                                                                                                      |
| NDR_3_10   | Support for updates                                                               | Offline upgrade supported<br> Runtime upgrade - not supported                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| NDR_3_10_1 | Update authenticity and integrity                                                 | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_3_11   | Physical tamper resistance and detection                                          | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_3_11_1 | Notification of a tampering attempt                                               | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_3_12   | Provisioning product supplier roots of trust                                      | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_3_13   | Provisioning asset owner roots of trust                                           | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| *NDR_3_14* | Integrity of the boot process                                                     | Check before starting the component hash and signature<br>Secure boot feature of the running container                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| NDR_3_14_1 | Authenticity of the boot process                                                  | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_5_2    | Zone boundary protection                                                          | DataApp on the boundary - responsibility of DataApp not to expose sensitive data                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| NDR_5_2_1  | Deny all, permit by exception                                                     | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_5_2_2  | Island mode                                                                       | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| NDR_5_2_3  | Fail close                                                                        | -                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| *NDR_5_3*  | General purpose, person-to-person communication restrictions                      | Prevent leaking of trusted data, prevent people privately using connector - responsibility of the system administrator to prevent such misuse<br>Install software only with permission granted (sys admin)                                                                                                                                                                                                                                                                                                                                                                                                                                |

|Marking | Explanation |
|-- | --|
|x | not compliant |
|- | not considered, next level of certification |
|italic| domain specific|
